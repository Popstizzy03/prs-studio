---
import LogbookLayout from '../layouts/LogbookLayout.astro';
import { getCollection } from 'astro:content';

// Fetch all logs and sort them by date (Newest First)
const logs = (await getCollection('logs')).sort(
	(a, b) => b.data.date.valueOf() - a.data.date.valueOf()
);
---

<LogbookLayout title="Index">
  
  <!-- Hero Section -->
  <section class="relative py-24 md:py-32 mb-20 border-b border-zinc-200 dark:border-zinc-800 -mx-6 px-6 md:-mx-0 md:px-0 bg-zinc-50 dark:bg-zinc-900 overflow-hidden">
    <div class="absolute inset-0 opacity-[0.53] bg-[url('/pics/3.jpg')] bg-cover bg-center grayscale pointer-events-none"></div>
    
    <div class="relative z-10">
      <div class="flex items-center gap-3 font-mono text-xs uppercase tracking-widest text-orange-600 dark:text-orange-500 mb-6">
        <span class="h-px w-8 bg-orange-600 dark:bg-orange-500"></span>
        <span>Lusaka, ZM</span>
      </div>
      
      <h1 class="font-sans text-6xl md:text-8xl font-bold tracking-tighter text-zinc-900 dark:text-zinc-100 mb-8">
        Sampa Mulenga
      </h1>
      
      <p class="font-serif text-xl md:text-2xl text-zinc-900 dark:text-zinc-200 leading-relaxed max-w-lg border-l-2 border-orange-600 dark:border-orange-500 pl-6">
        "A collection of drafts, textures, and thoughts from the studio."
      </p>
    </div>
  </section>

  <div class="space-y-12 relative">
    <!-- Vertical Timeline Line (Decorative) -->
    <div class="absolute left-0 top-2 bottom-0 w-px bg-zinc-200 dark:bg-zinc-800 hidden md:block"></div>

    <!-- Artist Intro (Pinned) -->
    <article class="relative pl-0 md:pl-8 group">
        <!-- Timeline Dot -->
        <div class="absolute left-[-4px] top-2 h-2 w-2 rounded-full bg-zinc-800 dark:bg-zinc-600 hidden md:block"></div>

        <!-- Meta Info -->
        <div class="font-mono text-[10px] uppercase tracking-widest text-zinc-400 dark:text-zinc-500 mb-2">
          Introduction
        </div>

        <a href="/bio" class="block group">
          <h2 class="font-sans text-2xl font-semibold text-zinc-900 dark:text-zinc-100 mb-3 group-hover:text-orange-600 dark:group-hover:text-orange-500 transition-colors">
            Sampa Mulenga
          </h2>
        </a>

        <p class="font-serif text-zinc-600 dark:text-zinc-400 mb-4 line-clamp-2">
          A musician and sound architect based in Lusaka. Exploring the intersection of traditional instrumentation and algorithmic composition.
        </p>
        
        <a href="/bio" class="inline-flex items-center gap-2 text-xs font-bold font-mono text-zinc-900 dark:text-zinc-100 hover:text-orange-600 dark:hover:text-orange-500 uppercase tracking-wider border-b border-zinc-200 dark:border-zinc-800 pb-0.5 hover:border-orange-600 dark:hover:border-orange-500 transition-all">
          Read Entry <span>→</span>
        </a>
    </article>

    {logs.map((log) => (
      <article class="relative pl-0 md:pl-8 group flex flex-col md:flex-row gap-6 justify-between items-start">
        
        <!-- Timeline Dot -->
        <div class="absolute left-[-4px] top-2 h-2 w-2 rounded-full bg-zinc-300 dark:bg-zinc-600 group-hover:bg-orange-600 dark:group-hover:bg-orange-500 transition-colors hidden md:block"></div>

        <div class="flex-1">
          <!-- Meta Info (Mobile: Top, Desktop: Inline-ish) -->
          <div class="font-mono text-[10px] uppercase tracking-widest text-zinc-400 dark:text-zinc-500 mb-2">
            {log.data.date.toLocaleDateString('en-GB', { 
              day: 'numeric', month: 'short', year: 'numeric' 
            })}
             / {log.data.tags.join(', ')}
          </div>

          <a href={`/logs/${log.slug}`} class="block group">
            <h2 class="font-sans text-2xl font-semibold text-zinc-900 dark:text-zinc-100 mb-3 group-hover:text-orange-600 dark:group-hover:text-orange-500 transition-colors">
              {log.data.title}
            </h2>
          </a>

          <p class="font-serif text-zinc-600 dark:text-zinc-400 mb-4 line-clamp-2">
            {log.body.slice(0, 180)}...
          </p>
          
          <a href={`/logs/${log.slug}`} class="inline-flex items-center gap-2 text-xs font-bold font-mono text-zinc-900 dark:text-zinc-100 hover:text-orange-600 dark:hover:text-orange-500 uppercase tracking-wider border-b border-zinc-200 dark:border-zinc-800 pb-0.5 hover:border-orange-600 dark:hover:border-orange-500 transition-all">
            Read Entry <span>→</span>
          </a>
        </div>

        {log.data.cover && (
          <a href={`/logs/${log.slug}`} class="shrink-0 block">
            <img src={log.data.cover} alt={log.data.title} class="w-24 h-24 md:w-32 md:h-32 object-cover grayscale group-hover:grayscale-0 transition-all duration-500 border border-zinc-200 dark:border-zinc-800" />
          </a>
        )}
      </article>
    ))}
  </div>
</LogbookLayout> 
