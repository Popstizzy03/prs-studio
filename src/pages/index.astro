---
import LogbookLayout from '../layouts/LogbookLayout.astro';
import { getCollection } from 'astro:content';

// Fetch all logs and sort them by date (Newest First)
const logs = (await getCollection('logs')).sort(
	(a, b) => b.data.date.valueOf() - a.data.date.valueOf()
);
---

<LogbookLayout title="Index">
  
  <header class="mb-16 border-b border-zinc-200 pb-8">
    <h1 class="font-sans text-4xl font-bold tracking-tight text-zinc-900 mb-4">
      Session Logs
    </h1>
    <p class="font-serif text-lg text-zinc-600 italic">
      "A collection of drafts, textures, and thoughts from the studio."
    </p>
  </header>

  <div class="space-y-12 relative">
    <!-- Vertical Timeline Line (Decorative) -->
    <div class="absolute left-0 top-2 bottom-0 w-px bg-zinc-200 hidden md:block"></div>

    <!-- Artist Intro (Pinned) -->
    <article class="relative pl-0 md:pl-8 group flex flex-col md:flex-row gap-6 justify-between items-start">
        <!-- Timeline Dot -->
        <div class="absolute left-[-4px] top-2 h-2 w-2 rounded-full bg-zinc-800 hidden md:block"></div>

        <div class="flex-1">
          <!-- Meta Info -->
          <div class="font-mono text-[10px] uppercase tracking-widest text-zinc-400 mb-2">
            Introduction
          </div>

          <a href="/bio" class="block group">
            <h2 class="font-sans text-2xl font-semibold text-zinc-900 mb-3 group-hover:text-orange-600 transition-colors">
              Sampa Mulenga
            </h2>
          </a>

          <p class="font-serif text-zinc-600 mb-4 line-clamp-2">
            A musician and sound architect based in Lusaka. Exploring the intersection of traditional instrumentation and algorithmic composition.
          </p>
          
          <a href="/bio" class="inline-flex items-center gap-2 text-xs font-bold font-mono text-zinc-900 hover:text-orange-600 uppercase tracking-wider border-b border-zinc-200 pb-0.5 hover:border-orange-600 transition-all">
            Read Entry <span>→</span>
          </a>
        </div>

        <a href="/bio" class="shrink-0 block">
          <img src="/pics/3.jpg" alt="Sampa Mulenga" class="w-24 h-24 md:w-32 md:h-32 object-cover grayscale hover:grayscale-0 transition-all duration-500 border border-zinc-200" />
        </a>
    </article>

    {logs.map((log) => (
      <article class="relative pl-0 md:pl-8 group flex flex-col md:flex-row gap-6 justify-between items-start">
        
        <!-- Timeline Dot -->
        <div class="absolute left-[-4px] top-2 h-2 w-2 rounded-full bg-zinc-300 group-hover:bg-orange-600 transition-colors hidden md:block"></div>

        <div class="flex-1">
          <!-- Meta Info (Mobile: Top, Desktop: Inline-ish) -->
          <div class="font-mono text-[10px] uppercase tracking-widest text-zinc-400 mb-2">
            {log.data.date.toLocaleDateString('en-GB', { 
              day: 'numeric', month: 'short', year: 'numeric' 
            })}
             / {log.data.tags.join(', ')}
          </div>

          <a href={`/logs/${log.slug}`} class="block group">
            <h2 class="font-sans text-2xl font-semibold text-zinc-900 mb-3 group-hover:text-orange-600 transition-colors">
              {log.data.title}
            </h2>
          </a>

          <p class="font-serif text-zinc-600 mb-4 line-clamp-2">
            {log.body.slice(0, 180)}...
          </p>
          
          <a href={`/logs/${log.slug}`} class="inline-flex items-center gap-2 text-xs font-bold font-mono text-zinc-900 hover:text-orange-600 uppercase tracking-wider border-b border-zinc-200 pb-0.5 hover:border-orange-600 transition-all">
            Read Entry <span>→</span>
          </a>
        </div>

        {log.data.cover && (
          <a href={`/logs/${log.slug}`} class="shrink-0 block">
            <img src={log.data.cover} alt={log.data.title} class="w-24 h-24 md:w-32 md:h-32 object-cover grayscale hover:grayscale-0 transition-all duration-500 border border-zinc-200" />
          </a>
        )}
      </article>
    ))}
  </div>
</LogbookLayout> 
