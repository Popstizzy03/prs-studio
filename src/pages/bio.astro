---
import LogbookLayout from '../layouts/LogbookLayout.astro';
import Timeline from '../components/bio/Timeline.svelte';
import { getCollection } from 'astro:content';
import { marked } from 'marked';

const timelineEntries = await getCollection('timeline');
const sortedTimeline = timelineEntries.sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf());

const events = await Promise.all(sortedTimeline.map(async (entry) => ({
  ...entry,
  body: await marked.parse(entry.body),
  excerpt: entry.body.substring(0, 100) + "..."
})));
---

<LogbookLayout title="Bio">
  <div class="grid md:grid-cols-2 gap-12 items-start mb-24">
    
    <!-- Left: Image -->
    <div class="aspect-[4/5] relative overflow-hidden">
      <img 
        src="/pics/5.jpg" 
        alt="Sampa Mulenga Portrait" 
        class="absolute inset-0 w-full h-full object-cover grayscale hover:grayscale-0 transition-all duration-500" 
      />
    </div>

    <!-- Right: The Specs -->
    <div>
      <h1 class="font-sans text-4xl font-bold tracking-tight text-zinc-900 dark:text-zinc-100 mb-6">
        Sampa Mulenga
      </h1>
      
      <div class="prose prose-zinc dark:prose-invert mb-8">
        <p>
          A musician and sound architect based in Lusaka. Exploring the intersection of traditional instrumentation and algorithmic composition.
        </p>
        <p>
          The studio is not just a place of recording, but a laboratory for texture, time, and memory.
        </p>
      </div>

      <!-- Technical Data List -->
      <div class="border-t border-zinc-200 dark:border-zinc-800 pt-6">
        <h3 class="font-mono text-xs uppercase tracking-widest text-zinc-500 dark:text-zinc-400 mb-4">Specs</h3>
        <ul class="space-y-2 font-mono text-sm text-zinc-700 dark:text-zinc-300">
          <li class="flex justify-between">
            <span>Primary Instrument</span>
            <span class="text-zinc-400 dark:text-zinc-500">Piano / Synth</span>
          </li>
          <li class="flex justify-between">
            <span>DAW</span>
            <span class="text-zinc-400 dark:text-zinc-500">Ableton Live</span>
          </li>
          <li class="flex justify-between">
            <span>Location</span>
            <span class="text-zinc-400 dark:text-zinc-500">Lusaka, Zambia</span>
          </li>
        </ul>
      </div>
    </div>
  </div>

  <!-- Timeline Section -->
  <section class="max-w-2xl mx-auto border-t border-zinc-200 dark:border-zinc-800 pt-16">
    <h2 class="font-sans text-2xl font-bold text-zinc-900 dark:text-zinc-100 mb-12">Trajectory</h2>
    <Timeline client:visible events={events} />
  </section>

</LogbookLayout>